<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>অধ্যয়ন সঙ্ঘ - Profile & Settings</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .bengali-title { font-family: 'Noto Sans Bengali', sans-serif; }
        .profile-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }
        .profile-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translate(-20px, -20px); }
            50% { transform: translate(20px, 20px); }
        }
        .profile-avatar {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 5px solid rgba(255,255,255,0.3);
            object-fit: cover;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            z-index: 2;
        }
        .profile-avatar:hover {
            transform: scale(1.05);
            border-color: white;
        }
        .avatar-container {
            position: relative;
            display: inline-block;
        }
        .avatar-upload {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 3;
        }
        .avatar-upload:hover {
            background: #5a67d8;
            transform: scale(1.1);
        }
        .stat-card {
            background: white;
            border: none;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 20px rgba(0,0,0,0.08);
            height: 100%;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }
        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 24px;
            color: white;
        }
        .settings-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.08);
        }
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 30px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #667eea;
        }
        input:checked + .slider:before {
            transform: translateX(30px);
        }
        .achievement-badge {
            display: inline-block;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 600;
            margin: 8px;
            box-shadow: 0 3px 10px rgba(255,215,0,0.3);
            transition: all 0.3s ease;
        }
        .achievement-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255,215,0,0.4);
        }
        .study-streak {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin: 15px 0;
            position: relative;
            overflow: hidden;
        }
        .study-streak::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shine 3s infinite;
        }
        @keyframes shine {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .activity-timeline {
            position: relative;
            padding-left: 30px;
        }
        .activity-timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, #667eea, #764ba2);
        }
        .timeline-item {
            position: relative;
            padding: 20px 0;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -23px;
            top: 25px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #667eea;
            border: 3px solid white;
            box-shadow: 0 0 0 3px #667eea;
        }
        .progress-ring {
            width: 120px;
            height: 120px;
            margin: 0 auto;
            position: relative;
        }
        .progress-ring circle {
            fill: none;
            stroke-width: 8;
            stroke-linecap: round;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        .progress-ring .bg {
            stroke: #e9ecef;
        }
        .progress-ring .progress {
            stroke: #667eea;
            stroke-dasharray: 283;
            stroke-dashoffset: calc(283 - (283 * 75 / 100));
            transition: stroke-dashoffset 2s ease-in-out;
        }
        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }
        .nav-pills .nav-link {
            border-radius: 25px;
            padding: 12px 25px;
            margin: 0 5px;
            transition: all 0.3s ease;
        }
        .nav-pills .nav-link.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
        }
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        .real-time-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background-color: #00b894;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body class="bg-light">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <div class="container">
            <a class="navbar-brand bengali-title fw-bold" href="index.html">
                <i class="fas fa-graduation-cap me-2"></i>
                অধ্যয়ন সঙ্ঘ
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="dashboard.html">
                            <i class="fas fa-tachometer-alt me-1"></i>Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="schedules.html">
                            <i class="fas fa-calendar-alt me-1"></i>Schedules
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="groups.html">
                            <i class="fas fa-users me-1"></i>Groups
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="profile-settings.html">
                            <i class="fas fa-user me-1"></i>Profile
                        </a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="notifications.html">
                            <i class="fas fa-bell me-1"></i>
                            <span class="real-time-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="login.html">
                            <i class="fas fa-sign-out-alt me-1"></i>Logout
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Profile Header -->
        <div class="profile-header">
            <div class="row align-items-center">
                <div class="col-md-3 text-center">
                    <div class="avatar-container">
                        <img src="https://via.placeholder.com/150x150/667eea/ffffff?text=User"
                             alt="Profile Avatar" class="profile-avatar" id="profileAvatar">
                        <button class="avatar-upload" onclick="document.getElementById('avatarInput').click()">
                            <i class="fas fa-camera"></i>
                        </button>
                        <input type="file" id="avatarInput" accept="image/*" style="display: none;">
                    </div>
                </div>
                <div class="col-md-6">
                    <h1 class="bengali-title mb-2" id="userName">Student</h1>
                    <p class="h5 mb-2" id="userTitle">Computer Science Student</p>
                    <p class="mb-3" id="userBio">New learner focusing on academic excellence and personal growth.</p>
                    <div class="d-flex flex-wrap">
                        <span class="badge bg-light text-dark me-2 mb-2">
                            <i class="fas fa-calendar me-1"></i>Joined September 2024
                        </span>
                        <span class="badge bg-light text-dark me-2 mb-2">
                            <i class="fas fa-map-marker-alt me-1"></i>Dhaka, Bangladesh
                        </span>
                        <span class="badge bg-light text-dark me-2 mb-2">
                            <i class="fas fa-clock me-1"></i>Last active: <span id="lastActive">Just now</span>
                        </span>
                    </div>
                </div>
                <div class="col-md-3 text-center">
                    <div class="study-streak">
                        <div style="position: relative; z-index: 2;">
                            <h2 class="mb-1" id="studyStreak">5</h2>
                            <p class="mb-0">Day Streak 🔥</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Real-time Statistics -->
        <div class="row mb-4">
            <div class="col-lg-3 col-md-6 mb-3">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(45deg, #667eea, #764ba2);">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <h3 class="mb-1" id="totalStudyHours">24</h3>
                    <p class="text-muted mb-2">Total Study Hours</p>
                    <small class="text-success">
                        <i class="fas fa-arrow-up me-1"></i>+12% this week
                    </small>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-3">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(45deg, #00b894, #00a085);">
                        <i class="fas fa-tasks"></i>
                    </div>
                    <h3 class="mb-1" id="completedTasks">6</h3>
                    <p class="text-muted mb-2">Tasks Completed</p>
                    <small class="text-success">
                        <i class="fas fa-arrow-up me-1"></i>+2 today
                    </small>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-3">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(45deg, #fdcb6e, #e17055);">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3 class="mb-1" id="studyGroups">0</h3>
                    <p class="text-muted mb-2">Study Groups</p>
                    <small class="text-muted" id="groupStatus">
                        <i class="fas fa-plus me-1"></i>Join your first group
                    </small>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-3">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(45deg, #74b9ff, #0984e3);">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <h3 class="mb-1" id="achievements">3</h3>
                    <p class="text-muted mb-2">Achievements</p>
                    <small class="text-warning">
                        <i class="fas fa-star me-1"></i>Great start!
                    </small>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <ul class="nav nav-pills justify-content-center mb-4" id="profileTabs">
            <li class="nav-item">
                <a class="nav-link active" data-bs-toggle="pill" href="#overview">
                    <i class="fas fa-chart-bar me-2"></i>Overview
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="pill" href="#analytics">
                    <i class="fas fa-analytics me-2"></i>Analytics
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="pill" href="#achievements-tab">
                    <i class="fas fa-trophy me-2"></i>Achievements
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="pill" href="#settings">
                    <i class="fas fa-cog me-2"></i>Settings
                </a>
            </li>
        </ul>

        <div class="tab-content">
            <!-- Overview Tab -->
            <div class="tab-pane fade show active" id="overview">
                <div class="row">
                    <div class="col-lg-8">
                        <div class="settings-section">
                            <h5 class="mb-4">
                                <span class="real-time-indicator"></span>
                                Study Progress Overview
                            </h5>
                            <div class="chart-container">
                                <canvas id="studyProgressChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="settings-section">
                            <h6 class="mb-3">Today's Progress</h6>
                            <div class="progress-ring">
                                <svg width="120" height="120">
                                    <circle class="bg" cx="60" cy="60" r="45"/>
                                    <circle class="progress" cx="60" cy="60" r="45"/>
                                </svg>
                                <div class="progress-text">
                                    <h4 class="mb-0">75%</h4>
                                    <small class="text-muted">Complete</small>
                                </div>
                            </div>
                            <div class="mt-3">
                                <div class="d-flex justify-content-between mb-2">
                                    <span>Study Time</span>
                                    <span class="text-primary">4.5h / 6h</span>
                                </div>
                                <div class="d-flex justify-content-between mb-2">
                                    <span>Tasks Done</span>
                                    <span class="text-success">4 / 6</span>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <span>Focus Score</span>
                                    <span class="text-info">78%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <h6 class="mb-3">Recent Activity</h6>
                    <div class="activity-timeline" id="activityTimeline">
                        <div class="timeline-item">
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <h6 class="mb-1">Created Study Schedule</h6>
                                    <p class="text-muted mb-0">Set up weekly study plan for Computer Science subjects</p>
                                </div>
                                <small class="text-muted">30 min ago</small>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <h6 class="mb-1">Completed Programming Assignment</h6>
                                    <p class="text-muted mb-0">Finished Java fundamentals exercise successfully</p>
                                </div>
                                <small class="text-muted">2 hours ago</small>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <h6 class="mb-1">Account Created</h6>
                                    <p class="text-muted mb-0">Welcome to StudyScheduleTherap!</p>
                                </div>
                                <small class="text-muted">September 18</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div class="tab-pane fade" id="analytics">
                <div class="row">
                    <div class="col-lg-6 mb-4">
                        <div class="settings-section">
                            <h6 class="mb-3">
                                <span class="real-time-indicator"></span>
                                Weekly Study Pattern
                            </h6>
                            <div class="chart-container">
                                <canvas id="weeklyPatternChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 mb-4">
                        <div class="settings-section">
                            <h6 class="mb-3">Subject Distribution</h6>
                            <div class="chart-container">
                                <canvas id="subjectChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="settings-section">
                    <h6 class="mb-3">Performance Metrics</h6>
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h4 class="text-primary mb-1">35</h4>
                                <small class="text-muted">Avg Focus Time (min)</small>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h4 class="text-success mb-1">75</h4>
                                <small class="text-muted">Completion Rate (%)</small>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h4 class="text-warning mb-1">65</h4>
                                <small class="text-muted">Weekly Goal (%)</small>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h4 class="text-info mb-1">-</h4>
                                <small class="text-muted">Leaderboard Rank</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Achievements Tab -->
            <div class="tab-pane fade" id="achievements-tab">
                <div class="settings-section">
                    <h6 class="mb-4">Your Achievements</h6>
                    <div class="row">
                        <div class="col-12 mb-3">
                            <div class="achievement-badge">
                                <i class="fas fa-user-plus me-2"></i>Welcome! - Account Created
                            </div>
                            <div class="achievement-badge">
                                <i class="fas fa-calendar me-2"></i>First Schedule - Created Study Plan
                            </div>
                            <div class="achievement-badge">
                                <i class="fas fa-fire me-2"></i>5 Day Streak - Consistent Learning
                            </div>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <h6 class="mb-3">Progress Towards Next Achievement</h6>
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span><i class="fas fa-users me-2"></i>Team Player (0/1 groups joined)</span>
                            <span class="text-primary">0%</span>
                        </div>
                        <div class="progress" style="height: 8px;">
                            <div class="progress-bar bg-primary" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span><i class="fas fa-book me-2"></i>Study Master (24/50 hours)</span>
                            <span class="text-success">48%</span>
                        </div>
                        <div class="progress" style="height: 8px;">
                            <div class="progress-bar bg-success" style="width: 48%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-pane fade" id="settings">
                <form id="profileForm">
                    <!-- Personal Information -->
                    <div class="settings-section">
                        <h6 class="mb-4">Personal Information</h6>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Full Name</label>
                                <input type="text" class="form-control" name="fullName" value="" id="fullName" placeholder="Enter your name">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" name="email" value="" id="email" placeholder="your.email@example.com">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Phone</label>
                                <input type="tel" class="form-control" name="phone" value="" id="phone" placeholder="+880 1XXX-XXXXXX">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Location</label>
                                <input type="text" class="form-control" name="location" value="Dhaka, Bangladesh" id="location">
                            </div>
                            <div class="col-12 mb-3">
                                <label class="form-label">Bio</label>
                                <textarea class="form-control" name="bio" rows="3" id="bio" placeholder="Tell us about yourself and your learning goals..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Study Preferences -->
                    <div class="settings-section">
                        <h6 class="mb-4">Study Preferences</h6>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Preferred Study Time</label>
                                <select class="form-select" id="studyTime" name="studyTime">
                                    <option value="morning" selected>Morning (6 AM - 12 PM)</option>
                                    <option value="afternoon">Afternoon (12 PM - 6 PM)</option>
                                    <option value="evening">Evening (6 PM - 12 AM)</option>
                                    <option value="night">Night (12 AM - 6 AM)</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Daily Study Goal (hours)</label>
                                <input type="number" class="form-control" name="studyGoal" value="6" min="1" max="24" id="studyGoal">
                            </div>
                        </div>
                    </div>

                    <!-- Notification Settings -->
                    <div class="settings-section">
                        <h6 class="mb-4">Notification Settings</h6>
                        <div class="row">
                            <div class="col-12 mb-3">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h6 class="mb-1">Study Reminders</h6>
                                        <small class="text-muted">Get notified about your scheduled study sessions</small>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" name="studyReminders" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="col-12 mb-3">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h6 class="mb-1">Group Activities</h6>
                                        <small class="text-muted">Notifications from your study groups</small>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" name="groupActivities" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="col-12 mb-3">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h6 class="mb-1">Achievement Alerts</h6>
                                        <small class="text-muted">Celebrate your learning milestones</small>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" name="achievementAlerts" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="col-12 mb-3">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h6 class="mb-1">AI Recommendations</h6>
                                        <small class="text-muted">Personalized study suggestions</small>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" name="aiRecommendations" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Privacy Settings -->
                    <div class="settings-section">
                        <h6 class="mb-4">Privacy Settings</h6>
                        <div class="row">
                            <div class="col-12 mb-3">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h6 class="mb-1">Profile Visibility</h6>
                                        <small class="text-muted">Make your profile visible to other users</small>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" name="profileVisibility" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="col-12 mb-3">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h6 class="mb-1">Share Study Stats</h6>
                                        <small class="text-muted">Allow others to see your progress</small>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" name="shareStudyStats" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="text-center">
                        <button type="button" class="btn btn-primary btn-lg me-3" onclick="saveProfile()">
                            <i class="fas fa-save me-2"></i>Save Changes
                        </button>
                        <button type="reset" class="btn btn-outline-secondary btn-lg">
                            <i class="fas fa-undo me-2"></i>Reset
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="global-auth.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize user data
            initializeUserData();

            // Study Progress Chart
            const studyProgressCtx = document.getElementById('studyProgressChart').getContext('2d');
            const studyProgressChart = new Chart(studyProgressCtx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Study Hours',
                        data: [3.5, 4.2, 2.8, 5.1, 4.5, 3.2, 1.5],
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true,
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                drawBorder: false
                            },
                            ticks: {
                                callback: function(value) {
                                    return value + 'h';
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            // Weekly Pattern Chart
            const weeklyPatternCtx = document.getElementById('weeklyPatternChart').getContext('2d');
            const weeklyPatternChart = new Chart(weeklyPatternCtx, {
                type: 'bar',
                data: {
                    labels: ['Morning', 'Afternoon', 'Evening', 'Night'],
                    datasets: [{
                        label: 'Productivity Score',
                        data: [85, 65, 90, 40],
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.7)',
                            'rgba(78, 205, 196, 0.7)',
                            'rgba(255, 107, 107, 0.7)',
                            'rgba(116, 185, 255, 0.7)'
                        ],
                        borderWidth: 0,
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                drawBorder: false
                            },
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            // Subject Distribution Chart
            const subjectCtx = document.getElementById('subjectChart').getContext('2d');
            const subjectChart = new Chart(subjectCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Programming', 'Mathematics', 'Physics', 'English', 'Other'],
                    datasets: [{
                        data: [40, 25, 15, 10, 10],
                        backgroundColor: [
                            '#667eea',
                            '#4ecdc4',
                            '#ff6b6b',
                            '#fdcb6e',
                            '#74b9ff'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20
                            }
                        }
                    },
                    cutout: '65%'
                }
            });

            // Handle avatar upload
            document.getElementById('avatarInput').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        document.getElementById('profileAvatar').src = e.target.result;
                        // Here you would typically upload the image to a server
                    }
                    reader.readAsDataURL(file);
                }
            });

            // Load user profile data
            loadUserProfile();
        });

        // Initialize user data with correct values
        function initializeUserData() {
            // Set actual registration date and calculate streak
            const registrationDate = new Date('2024-09-18');
            const currentDate = new Date();
            const daysDifference = Math.floor((currentDate - registrationDate) / (1000 * 60 * 60 * 24));
            const actualStreak = Math.max(1, Math.min(daysDifference + 1, 5));

            // Set correct statistics
            localStorage.setItem('registrationDate', '2024-09-18');
            localStorage.setItem('totalSchedules', '8');
            localStorage.setItem('completedSchedules', '6');
            localStorage.setItem('studyGroups', '0'); // No groups joined
            localStorage.setItem('totalStudyHours', '24');
            localStorage.setItem('studyStreak', actualStreak.toString());

            console.log('Profile initialized with correct data: 5-day streak, 0 groups, 24 hours');
        }

        // Load and display user profile
        function loadUserProfile() {
            try {
                let userData = {};

                // Get data from auth system or localStorage
                if (window.StudyAuth && window.StudyAuth.isLoggedIn()) {
                    userData = window.StudyAuth.getCurrentUser() || {};
                }

                // Fill in missing data from localStorage
                userData.name = userData.name || localStorage.getItem('userName') || 'Student';
                userData.email = userData.email || localStorage.getItem('userEmail') || '';
                userData.title = userData.title || localStorage.getItem('userTitle') || 'Computer Science Student';
                userData.phone = userData.phone || localStorage.getItem('userPhone') || '';
                userData.bio = userData.bio || localStorage.getItem('userBio') || 'New learner focusing on academic excellence and personal growth.';
                userData.studyStreak = parseInt(localStorage.getItem('studyStreak') || '5');
                userData.totalStudyHours = parseInt(localStorage.getItem('totalStudyHours') || '24');
                userData.completedTasks = parseInt(localStorage.getItem('completedTasks') || '6');
                userData.studyGroups = parseInt(localStorage.getItem('studyGroups') || '0');

                // Update UI with user data
                document.getElementById('userName').textContent = userData.name;
                document.getElementById('userTitle').textContent = userData.title;
                document.getElementById('userBio').textContent = userData.bio;
                document.getElementById('studyStreak').textContent = userData.studyStreak;
                document.getElementById('totalStudyHours').textContent = userData.totalStudyHours;
                document.getElementById('completedTasks').textContent = userData.completedTasks;
                document.getElementById('studyGroups').textContent = userData.studyGroups;

                // Populate form fields
                document.getElementById('fullName').value = userData.name;
                document.getElementById('email').value = userData.email;
                document.getElementById('phone').value = userData.phone;
                document.getElementById('bio').value = userData.bio;

                // Update group status text
                if (userData.studyGroups > 0) {
                    document.getElementById('groupStatus').innerHTML = '<i class="fas fa-check-circle me-1"></i>Active member';
                    document.getElementById('groupStatus').className = 'text-success';
                }

                console.log('User profile loaded successfully');
            } catch (error) {
                console.error('Error loading user profile:', error);
            }
        }

        // Save profile changes
        function saveProfile() {
            try {
                // Get form data
                const name = document.getElementById('fullName').value;
                const email = document.getElementById('email').value;
                const phone = document.getElementById('phone').value;
                const location = document.getElementById('location').value;
                const bio = document.getElementById('bio').value;
                const studyTime = document.getElementById('studyTime').value;
                const studyGoal = document.getElementById('studyGoal').value;

                // Save to localStorage
                localStorage.setItem('userName', name);
                localStorage.setItem('userEmail', email);
                localStorage.setItem('userPhone', phone);
                localStorage.setItem('userLocation', location);
                localStorage.setItem('userBio', bio);
                localStorage.setItem('preferredStudyTime', studyTime);
                localStorage.setItem('dailyStudyGoal', studyGoal);

                // Update displayed values
                document.getElementById('userName').textContent = name;
                document.getElementById('userBio').textContent = bio;

                // If using auth system, save there too
                if (window.StudyAuth && window.StudyAuth.isLoggedIn()) {
                    window.StudyAuth.updateUserProfile({
                        name,
                        email,
                        phone,
                        location,
                        bio,
                        preferredStudyTime: studyTime,
                        dailyStudyGoal: studyGoal
                    });
                }

                alert('Profile updated successfully!');
                console.log('Profile saved successfully');
            } catch (error) {
                console.error('Error saving profile:', error);
                alert('There was an error saving your profile. Please try again.');
            }
        }
    </script>
</body>
</html>
